/**
 * @license
 * Copyright Andrey Chalkin <L2jLiga@gmail.com> (https://github.com/L2jLiga). All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/L2jLiga/fastify-decorators/blob/master/LICENSE
 */
import { ERROR_HANDLERS } from '../symbols/index.js';
import { ensureErrorHandlers } from './helpers/class-properties.js';
export function ErrorHandler(parameter) {
    return function ({ constructor }, handlerName) {
        ensureErrorHandlers(constructor);
        if (parameter == null) {
            constructor[ERROR_HANDLERS].push(handlerFactory(() => true, handlerName));
        }
        else if (typeof parameter === 'string') {
            constructor[ERROR_HANDLERS].push(handlerFactory((error) => (error === null || error === void 0 ? void 0 : error.code) === parameter, handlerName));
        }
        else {
            constructor[ERROR_HANDLERS].push(handlerFactory((error) => error instanceof parameter, handlerName));
        }
    };
}
function handlerFactory(accepts, handlerName) {
    return { accepts, handlerName };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXJyb3ItaGFuZGxlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2xpYi9kZWNvcmF0b3JzL2Vycm9yLWhhbmRsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7OztHQU1HO0FBR0gsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3JELE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBTXBFLE1BQU0sVUFBVSxZQUFZLENBQTZCLFNBQXNCO0lBQzdFLE9BQU8sVUFBVSxFQUFFLFdBQVcsRUFBTyxFQUFFLFdBQTRCO1FBQ2pFLG1CQUFtQixDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBRWpDLElBQUksU0FBUyxJQUFJLElBQUksRUFBRTtZQUNyQixXQUFXLENBQUMsY0FBYyxDQUFDLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxJQUFJLEVBQUUsV0FBVyxDQUFDLENBQUMsQ0FBQztTQUMzRTthQUFNLElBQUksT0FBTyxTQUFTLEtBQUssUUFBUSxFQUFFO1lBQ3hDLFdBQVcsQ0FBQyxjQUFjLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUMsS0FBcUIsRUFBRSxFQUFFLENBQUMsQ0FBQSxLQUFLLGFBQUwsS0FBSyx1QkFBTCxLQUFLLENBQUUsSUFBSSxNQUFLLFNBQVMsRUFBRSxXQUFXLENBQUMsQ0FBQyxDQUFDO1NBQ3JIO2FBQU07WUFDTCxXQUFXLENBQUMsY0FBYyxDQUFDLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDLEtBQWEsRUFBRSxFQUFFLENBQUMsS0FBSyxZQUFZLFNBQVMsRUFBRSxXQUFXLENBQUMsQ0FBQyxDQUFDO1NBQzlHO0lBQ0gsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQU1ELFNBQVMsY0FBYyxDQUFDLE9BQWdELEVBQUUsV0FBNEI7SUFDcEcsT0FBTyxFQUFFLE9BQU8sRUFBRSxXQUFXLEVBQUUsQ0FBQztBQUNsQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IEFuZHJleSBDaGFsa2luIDxMMmpMaWdhQGdtYWlsLmNvbT4gKGh0dHBzOi8vZ2l0aHViLmNvbS9MMmpMaWdhKS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhbiBNSVQtc3R5bGUgbGljZW5zZSB0aGF0IGNhbiBiZVxuICogZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBhdCBodHRwczovL2dpdGh1Yi5jb20vTDJqTGlnYS9mYXN0aWZ5LWRlY29yYXRvcnMvYmxvYi9tYXN0ZXIvTElDRU5TRVxuICovXG5cbmltcG9ydCB0eXBlIHsgSUVycm9ySGFuZGxlciB9IGZyb20gJy4uL2ludGVyZmFjZXMvaW5kZXguanMnO1xuaW1wb3J0IHsgRVJST1JfSEFORExFUlMgfSBmcm9tICcuLi9zeW1ib2xzL2luZGV4LmpzJztcbmltcG9ydCB7IGVuc3VyZUVycm9ySGFuZGxlcnMgfSBmcm9tICcuL2hlbHBlcnMvY2xhc3MtcHJvcGVydGllcy5qcyc7XG5pbXBvcnQgdHlwZSB7IENvbnN0cnVjdG9yIH0gZnJvbSAnLi9oZWxwZXJzL2luamVjdC1kZXBlbmRlbmNpZXMuanMnO1xuXG5leHBvcnQgZnVuY3Rpb24gRXJyb3JIYW5kbGVyKCk6IFByb3BlcnR5RGVjb3JhdG9yO1xuZXhwb3J0IGZ1bmN0aW9uIEVycm9ySGFuZGxlcihjb2RlOiBzdHJpbmcpOiBQcm9wZXJ0eURlY29yYXRvcjtcbmV4cG9ydCBmdW5jdGlvbiBFcnJvckhhbmRsZXI8VCBleHRlbmRzIEVycm9yPihjb25maWd1cmF0aW9uOiBDb25zdHJ1Y3RvcjxUPik6IFByb3BlcnR5RGVjb3JhdG9yO1xuZXhwb3J0IGZ1bmN0aW9uIEVycm9ySGFuZGxlcjxUIGV4dGVuZHMgRXJyb3JDb25zdHJ1Y3Rvcj4ocGFyYW1ldGVyPzogVCB8IHN0cmluZyk6IFByb3BlcnR5RGVjb3JhdG9yIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh7IGNvbnN0cnVjdG9yIH06IGFueSwgaGFuZGxlck5hbWU6IHN0cmluZyB8IHN5bWJvbCkge1xuICAgIGVuc3VyZUVycm9ySGFuZGxlcnMoY29uc3RydWN0b3IpO1xuXG4gICAgaWYgKHBhcmFtZXRlciA9PSBudWxsKSB7XG4gICAgICBjb25zdHJ1Y3RvcltFUlJPUl9IQU5ETEVSU10ucHVzaChoYW5kbGVyRmFjdG9yeSgoKSA9PiB0cnVlLCBoYW5kbGVyTmFtZSkpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHBhcmFtZXRlciA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGNvbnN0cnVjdG9yW0VSUk9SX0hBTkRMRVJTXS5wdXNoKGhhbmRsZXJGYWN0b3J5KChlcnJvcj86IEVycm9yV2l0aENvZGUpID0+IGVycm9yPy5jb2RlID09PSBwYXJhbWV0ZXIsIGhhbmRsZXJOYW1lKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0cnVjdG9yW0VSUk9SX0hBTkRMRVJTXS5wdXNoKGhhbmRsZXJGYWN0b3J5KChlcnJvcj86IEVycm9yKSA9PiBlcnJvciBpbnN0YW5jZW9mIHBhcmFtZXRlciwgaGFuZGxlck5hbWUpKTtcbiAgICB9XG4gIH07XG59XG5cbmludGVyZmFjZSBFcnJvcldpdGhDb2RlIGV4dGVuZHMgRXJyb3Ige1xuICBjb2RlPzogc3RyaW5nO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVyRmFjdG9yeShhY2NlcHRzOiA8VCBleHRlbmRzIEVycm9yPihlcnJvcj86IFQpID0+IGJvb2xlYW4sIGhhbmRsZXJOYW1lOiBzdHJpbmcgfCBzeW1ib2wpOiBJRXJyb3JIYW5kbGVyIHtcbiAgcmV0dXJuIHsgYWNjZXB0cywgaGFuZGxlck5hbWUgfTtcbn1cbiJdfQ==